<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistemas de cadastro de pessoas</title>
    <link rel="shortcut icon" href="favicpm.png" type="image/x-icon">
    <link rel="stylesheet" href="mystyle.css">
</head>

<body>
    <!-- <div id="inicio">
        <p id="p_ini">
            <label for="">Usuário </label>
            <input type="text" id="cpf">
        </p>
        <p id="p_ini">
            <label for="">Senha </label>
            <input type="text" id="senha">
        </p>
        <p id="p_ini">
            <button onclick="logar()">Logar</button>
        </p>
    </div> -->

    <div id="opcao">
        <button id="op_pessoa" onclick="opcao('pessoa')">Pessoa</button>
        <button id="op_agenda" onclick="opcao('agenda')">Agenda</button>
    </div>

    <!-- Seção Pessoa -->
    <div class="btn" id="btn-consulta">
        <h1>Cadastro Pessoa</h1>
        <div class="fundo">
            <p>
                <label for="">CPF: </label>
                <input type="text" id="cpf" minlength="14" maxlength="14">
            </p>
            <p>
                <label for="">Nome: </label>
                <input type="text" id="nome">
            </p>
            <p>
                <label for="">Contato: </label>
                <input type="text" id="ctt" minlength="11" maxlength="11">
            </p>
            <p>
                <label for="">Senha: </label>
                <input type="text" id="senha">
            </p>
        </div>
    </div>
    <div class="btns" id="btns-pessoa">
            <button onclick="inserir()">Inserir</button>
            <button onclick="consultar()">Consultar</button>
            <button onclick="deletar()">Deletar</button>
            <button onclick="atualizar()">Atualizar</button>
        </div>

    <!-- Seção Agenda -->
    <div class="btn" id="btn-consulta-agenda">
        <h1>Cadastro Agenda</h1> 
        <div class="fundo">
            <p>
                <label for="">CPF: </label>
                <input type="text" id="cpf_agenda" minlength="14" maxlength="14">
            </p>
            <p>
                <label for="">DATA: </label>
                <input type="date" id="data_agenda">
            </p>
            <p>
                <label for="">Descrição: </label>
                <input type="text" id="desc_agenda" maxlength="100">
            </p>
        </div>
    </div>
     <div class="btns" id="btns-agenda">
        <button onclick="inserir_agenda()">Inserir</button>
        <button onclick="consultar_agenda()">Consultar</button>
        <button onclick="deletar_agenda()">Deletar</button>
        <button onclick="atualizar_agenda()">Atualizar</button>
    </div>

    <div id="res">

    </div>

    <script>
        // function logar(){
        //     let cpf = document.getElementById('cpf').value;
        //     let senha = document.getElementById('senha').value;
        //     let requisicao = new XMLHttpRequest();
        //     requisicao.open("POST", `controllerPessoa.php?cpf=${cpf}&senha=${senha}&acao=validaPessoa`);
        //     requisicao.send();
        //     requisicao.onload = function(){
        //         let organizacao = JSON.parse(this.responseText)   
        //         if(organizacao.length > 0){
        //             document.getElementById('inicio').style.display = 'none';
        //             document.getElementById('opcao').style.display = 'block';
        //         }
        //     }
        // }

        function opcao(op){
            if(op == 'pessoa'){
                document.getElementById('btn-consulta').style.display = 'block';
                document.getElementById('btns-pessoa').style.display = 'flex';
            } else if(op == 'agenda'){
                document.getElementById('btn-consulta-agenda').style.display = 'block';
                document.getElementById('btns-agenda').style.display = 'flex';
            }
            document.getElementById('opcao').style.display = 'none';
        }

        // Funções para Pessoa
        function inserir(){
            let requisicao = new XMLHttpRequest();
            let cpf = document.getElementById('cpf').value;
            let nome = document.getElementById('nome').value;
            let ctt = document.getElementById('ctt').value;
            let senha = document.getElementById('senha').value;

            requisicao.open("GET", `controllerPessoa.php?cpf=${cpf}&nome=${nome}&contato=${ctt}&senha=${senha}&acao=inserir`);
            requisicao.send();

            requisicao.onload = function(){
                document.getElementById('res').innerHTML = this.responseText;
            }
        }

        function consultar(){
            const btn = document.getElementById('btn-consulta');
            let requisicao = new XMLHttpRequest();
            requisicao.open("POST", "controllerPessoa.php?acao=consultar");
            requisicao.send();

            requisicao.onload = function(){
                let organizacao = JSON.parse(this.responseText)   
                let res = ""      
                for(i = 0; i < organizacao.length ; i++){
                    res = `
                    <div id="fundo">
                        <div class="txt">
                            Nome: ${organizacao[i].nome}
                        </div>
                        <div class="txt">
                            CPF: ${organizacao[i].cpf}
                        </div>
                        <div class="txt">
                            Senha: ${organizacao[i].senha}
                        </div> 
                    </div>`;
                }
                document.getElementById('res').innerHTML = res;
                btn.style.display = 'hiden'
            }
        }

        function deletar(){
            let requisicao = new XMLHttpRequest();
            let cpf = document.getElementById('cpf').value;

            requisicao.open("GET", `controllerPessoa.php?cpf=${cpf}&acao=apagar`);
            requisicao.send();

            requisicao.onload = function(){
                document.getElementById('res').innerHTML = this.responseText;
            }
        }

        function atualizar(){
            let requisicao = new XMLHttpRequest();
            let cpf = document.getElementById('cpf').value;
            let nome = document.getElementById('nome').value;
            let ctt = document.getElementById('ctt').value;
            let senha = document.getElementById('senha').value;

            requisicao.open("GET", `controllerPessoa.php?cpf=${cpf}&nome=${nome}&contato=${ctt}&senha=${senha}&acao=atualizar`);
            requisicao.send();

            requisicao.onload = function(){
                document.getElementById('res').innerHTML = this.responseText;
            }
        }

        // Funções para Agenda
        function inserir_agenda(){
            let requisicao = new XMLHttpRequest();
            let cpf = document.getElementById('cpf_agenda').value;
            let data = document.getElementById('data_agenda').value;
            let descricao = document.getElementById('desc_agenda').value;

            requisicao.open("GET", `controllerAgenda.php?cpf=${cpf}&data=${data}&descricao=${descricao}&acao=inserir`);
            requisicao.send();

            requisicao.onload = function(){
                document.getElementById('res').innerHTML = this.responseText;
            }
        }

        function consultar_agenda(){
            const btn = document.getElementById('btn-consulta-agenda');
            let requisicao = new XMLHttpRequest();
            requisicao.open("POST", "controllerAgenda.php?acao=consultar");
            requisicao.send();

            requisicao.onload = function(){
                let organizacao = JSON.parse(this.responseText)   
                let res = ""      
                for(i = 0; i < organizacao.length ; i++){
                    res = `
                    <div id="fundo">
                        <div class="txt">
                            CPF: ${organizacao[i].cpf}
                        </div>
                        <div class="txt">
                            Data: ${organizacao[i].data}
                        </div>
                        <div class="txt">
                            Descrição: ${organizacao[i].descricao}
                        </div> 
                    </div>`;
                }
                document.getElementById('res').innerHTML = res;
                btn.style.display = 'hiden'
            }
        }

        function deletar_agenda(){
            let requisicao = new XMLHttpRequest();
            let cpf = document.getElementById('cpf_agenda').value;

            requisicao.open("GET", `controllerAgenda.php?cpf=${cpf}&acao=apagar`);
            requisicao.send();

            requisicao.onload = function(){
                document.getElementById('res').innerHTML = this.responseText;
            }
        }

        function atualizar_agenda(){
            let requisicao = new XMLHttpRequest();
            let cpf = document.getElementById('cpf_agenda').value;
            let data = document.getElementById('data_agenda').value;
            let descricao = document.getElementById('desc_agenda').value;

            requisicao.open("GET", `controllerAgenda.php?cpf=${cpf}&data=${data}&descricao=${descricao}&acao=atualizar`);
            requisicao.send();

            requisicao.onload = function(){
                document.getElementById('res').innerHTML = this.responseText;
            }
        }
    </script>
</body>
</html>